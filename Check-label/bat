@echo off
rem проверка 3х параметров
if "%~1" == "" goto с
if "%~2" == "" goto с
if "%~3" == "" goto с

rem проверка метки
vol %1: | find "%2"
rem если метка найдена, еррорлевел будет = 0
rem если не найден метка вывод сообщения и выход из программы
if %Errorlevel%==0 (echo Counting files...) else (goto a)
rem открыть логический диск
%1:
rem перейти в корневой каталог
cd %1:\..

:b
rem вывод сообщения о том какие файлы ищутся
echo %1:\*.%3
rem обнуление счетчика
set /a CNT = 0
rem цикл рекурсивного поиска файлов с расширением на диске
for /r %%f in (*.%3) do (
rem увеличиваем счетчик на 1 когда найден файл
set /a CNT += 1
)
rem вывод результатов
echo Founded %CNT% .%3 files 
rem смещение параметров к следущему расширению
shift /3
rem если ещё есть расширение ищем файлы с этим расширением
if not "%~3" == "" goto b
rem иначе выходим из сценария
goto :EOF

:a
echo Disk %1 is not %2! Error %Errorlevel%
goto :EOF
:c
echo No enough parameters (must be 3)
goto:EOF       @echo off
rem проверка 3х параметров
if "%~1" == "" goto с
if "%~2" == "" goto с
if "%~3" == "" goto с

rem проверка метки
vol %1: | find "%2"
rem если метка найдена, еррорлевел будет = 0
rem если не найден метка вывод сообщения и выход из программы
if %Errorlevel%==0 (echo Counting files...) else (goto a)
rem открыть логический диск
%1:
rem перейти в корневой каталог
cd %1:\..

:b
rem вывод сообщения о том какие файлы ищутся
echo %1:\*.%3
rem обнуление счетчика
set /a CNT = 0
rem цикл рекурсивного поиска файлов с расширением на диске
for /r %%f in (*.%3) do (
rem увеличиваем счетчик на 1 когда найден файл
set /a CNT += 1
)
rem вывод результатов
echo Founded %CNT% .%3 files 
rem смещение параметров к следущему расширению
shift /3
rem если ещё есть расширение ищем файлы с этим расширением
if not "%~3" == "" goto b
rem иначе выходим из сцен